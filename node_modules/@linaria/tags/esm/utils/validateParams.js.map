{"version":3,"file":"validateParams.js","names":["isValidParams","params","constraints","i","length","constraint","undefined","Array","isArray","every","c","validateParams","message","Error"],"sources":["../../src/utils/validateParams.ts"],"sourcesContent":["import type { Param, Params } from '../types';\n\ntype ParamName = Param[0];\ntype ParamConstraint = ParamName | [...ParamName[]] | '*';\n\nexport type ParamConstraints =\n  | [...ParamConstraint[]]\n  | [...ParamConstraint[], '...'];\n\ntype GetParamByName<T> = T extends '*'\n  ? Param\n  : T extends (infer TNames extends ParamName)[]\n  ? Extract<Param, readonly [TNames, ...unknown[]]>\n  : T extends ParamName\n  ? Extract<Param, readonly [T, ...unknown[]]>\n  : never;\n\nexport type MapParams<\n  TNames extends ParamConstraints,\n  TRes extends Param[] = []\n> = TNames extends [infer THead, ...infer TTail extends ParamConstraints]\n  ? THead extends '...'\n    ? [...TRes, ...Params]\n    : MapParams<TTail, [...TRes, GetParamByName<THead>]>\n  : TRes;\n\nexport function isValidParams<T extends ParamConstraints>(\n  params: Params,\n  constraints: T\n): params is MapParams<T> {\n  for (let i = 0; i < constraints.length; i++) {\n    const constraint = constraints[i];\n    if (constraint === '...') {\n      return true;\n    }\n\n    if (constraint === '*') {\n      if (params[i] === undefined) {\n        return false;\n      }\n    } else if (Array.isArray(constraint)) {\n      if (constraint.every((c) => c !== params[i]?.[0])) {\n        return false;\n      }\n    } else if (constraint !== params[i]?.[0]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function validateParams<T extends ParamConstraints>(\n  params: Params,\n  constraints: T,\n  message: string\n): asserts params is MapParams<T> {\n  if (!isValidParams(params, constraints)) {\n    throw new Error(message);\n  }\n}\n"],"mappings":"AA0BA,OAAO,SAASA,aAAa,CAC3BC,MAAc,EACdC,WAAc,EACU;EACxB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,WAAW,CAACE,MAAM,EAAED,CAAC,EAAE,EAAE;IAC3C,MAAME,UAAU,GAAGH,WAAW,CAACC,CAAC,CAAC;IACjC,IAAIE,UAAU,KAAK,KAAK,EAAE;MACxB,OAAO,IAAI;IACb;IAEA,IAAIA,UAAU,KAAK,GAAG,EAAE;MACtB,IAAIJ,MAAM,CAACE,CAAC,CAAC,KAAKG,SAAS,EAAE;QAC3B,OAAO,KAAK;MACd;IACF,CAAC,MAAM,IAAIC,KAAK,CAACC,OAAO,CAACH,UAAU,CAAC,EAAE;MACpC,IAAIA,UAAU,CAACI,KAAK,CAAEC,CAAC,IAAKA,CAAC,KAAKT,MAAM,CAACE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;QACjD,OAAO,KAAK;MACd;IACF,CAAC,MAAM,IAAIE,UAAU,KAAKJ,MAAM,CAACE,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE;MACxC,OAAO,KAAK;IACd;EACF;EAEA,OAAO,IAAI;AACb;AAEA,OAAO,SAASQ,cAAc,CAC5BV,MAAc,EACdC,WAAc,EACdU,OAAe,EACiB;EAChC,IAAI,CAACZ,aAAa,CAACC,MAAM,EAAEC,WAAW,CAAC,EAAE;IACvC,MAAM,IAAIW,KAAK,CAACD,OAAO,CAAC;EAC1B;AACF"}